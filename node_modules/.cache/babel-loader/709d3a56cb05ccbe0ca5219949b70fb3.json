{"ast":null,"code":"import _slicedToArray from\"D:/ReactProjetos/alganews-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Button,Card,Col,Row,Skeleton,Space,Typography,Progress,Descriptions,Divider,Popconfirm,Table,Switch,Tooltip}from'antd';import Avatar from'antd/lib/avatar/avatar';import useBreakpoint from'antd/lib/grid/hooks/useBreakpoint';import confirm from'antd/lib/modal/confirm';import{useEffect}from'react';import{Link,Redirect,useParams}from'react-router-dom';import useUser from'../../core/hooks/useUser';import{WarningFilled}from'@ant-design/icons';import moment from'moment';import usePosts from'../../core/hooks/usePosts';import NotFoundError from'../components/NotFoundError';import usePageTitle from'../../core/hooks/usePageTitle';import{useState}from'react';import formatPhone from'../../core/utils/formatPhone';import useBreadcrumb from'../../core/hooks/useBreadcrumb';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function UserDetailsView(){var _user$skills,_user$skills2;usePageTitle('Detalhes do usuário');var params=useParams();var _useState=useState(0),_useState2=_slicedToArray(_useState,2),page=_useState2[0],setPage=_useState2[1];var _useBreakpoint=useBreakpoint(),lg=_useBreakpoint.lg;var _useUser=useUser(),user=_useUser.user,fetchUser=_useUser.fetchUser,notFound=_useUser.notFound,toggleUserStatus=_useUser.toggleUserStatus;useBreadcrumb(\"Usu\\xE1rios/\".concat((user===null||user===void 0?void 0:user.name)||'Detalhes'));var _usePosts=usePosts(),fetchUserPosts=_usePosts.fetchUserPosts,posts=_usePosts.posts,togglePostStatus=_usePosts.togglePostStatus,loadingFetch=_usePosts.loadingFetch,loadingToggle=_usePosts.loadingToggle;useEffect(function(){if(!isNaN(Number(params.id)))fetchUser(Number(params.id));},[fetchUser,params.id]);useEffect(function(){if((user===null||user===void 0?void 0:user.role)==='EDITOR')fetchUserPosts(user.id,page);},[fetchUserPosts,user,page]);if(isNaN(Number(params.id)))return/*#__PURE__*/_jsx(Redirect,{to:'/usuarios'});if(notFound)return/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(NotFoundError,{title:'Usuário não encontrado',actionDestination:'/usuarios',actionTitle:'Voltar para lista de usuários'})});if(!user)return/*#__PURE__*/_jsx(Skeleton,{});return/*#__PURE__*/_jsxs(Row,{gutter:24,children:[/*#__PURE__*/_jsx(Col,{xs:24,lg:4,children:/*#__PURE__*/_jsx(Row,{justify:'center',children:/*#__PURE__*/_jsx(Avatar,{size:120,src:user.avatarUrls.small})})}),/*#__PURE__*/_jsx(Col,{xs:24,lg:20,children:/*#__PURE__*/_jsxs(Space,{style:{width:'100%'},direction:'vertical',align:lg?'start':'center',children:[/*#__PURE__*/_jsx(Typography.Title,{level:2,children:user.name}),/*#__PURE__*/_jsx(Typography.Paragraph,{style:{textAlign:lg?'left':'center'},ellipsis:{rows:2},children:user.bio}),/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Link,{to:\"/usuarios/edicao/\".concat(user.id),children:/*#__PURE__*/_jsx(Button,{type:'primary',children:\"Editar perfil\"})}),/*#__PURE__*/_jsx(Popconfirm,{disabled:user.active&&!user.canBeDeactivated||!user.active&&!user.canBeActivated,title:user.active?\"Desabilitar \".concat(user.name):\"Habilitar \".concat(user.name),onConfirm:function onConfirm(){confirm({icon:/*#__PURE__*/_jsx(WarningFilled,{style:{color:'#09f'}}),title:\"Tem certeza que deseja \".concat(user.active?\"desabilitar \".concat(user.name,\"?\"):\"habilitar \".concat(user.name,\"?\")),onOk:function onOk(){toggleUserStatus(user).then(function(){fetchUser(Number(params.id));});},content:user.active?'Desabilitar um usuário fará com que ele seja automaticamente desligado da plataforma, podendo causar prejuízos em seus ganhos.':'Habilitar um usuário fará com que ele ganhe acesso a plataforma novamente, possibilitando criação e publicação de posts.'});},children:/*#__PURE__*/_jsx(Button,{disabled:user.active&&!user.canBeDeactivated||!user.active&&!user.canBeActivated,type:'primary',children:user.active?'Desabilitar':'Habilitar'})})]})]})}),/*#__PURE__*/_jsx(Divider,{}),!!((_user$skills=user.skills)===null||_user$skills===void 0?void 0:_user$skills.length)&&/*#__PURE__*/_jsx(Col,{xs:24,lg:12,children:/*#__PURE__*/_jsx(Space,{direction:\"vertical\",style:{width:'100%'},children:(_user$skills2=user.skills)===null||_user$skills2===void 0?void 0:_user$skills2.map(function(skill){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Typography.Text,{children:skill.name}),/*#__PURE__*/_jsx(Progress,{percent:skill.percentage,success:{percent:0}})]},skill.name);})})}),/*#__PURE__*/_jsx(Col,{xs:24,lg:12,children:/*#__PURE__*/_jsxs(Descriptions,{column:1,bordered:true,size:'small',children:[/*#__PURE__*/_jsx(Descriptions.Item,{label:'País',children:user.location.country}),/*#__PURE__*/_jsx(Descriptions.Item,{label:'Estado',children:user.location.state}),/*#__PURE__*/_jsx(Descriptions.Item,{label:'Cidade',children:user.location.city}),/*#__PURE__*/_jsx(Descriptions.Item,{label:'Telefone',children:formatPhone(user.phone)})]})}),user.role==='EDITOR'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(Col,{xs:24,children:/*#__PURE__*/_jsx(Table,{dataSource:posts===null||posts===void 0?void 0:posts.content,rowKey:'id',loading:loadingFetch,pagination:{onChange:function onChange(page){return setPage(page-1);},total:posts===null||posts===void 0?void 0:posts.totalElements,pageSize:10},columns:[{responsive:['xs'],title:'Posts',render:function render(element){return/*#__PURE__*/_jsxs(Descriptions,{column:1,children:[/*#__PURE__*/_jsx(Descriptions.Item,{label:'Título',children:element.title}),/*#__PURE__*/_jsx(Descriptions.Item,{label:'Criação',children:moment(element.createdAt).format('DD/MM/YYYY')}),/*#__PURE__*/_jsx(Descriptions.Item,{label:'Atualização',children:moment(element.updatedAt).format('DD/MM/YYYY')}),/*#__PURE__*/_jsx(Descriptions.Item,{label:'Publicado',children:/*#__PURE__*/_jsx(Switch,{checked:element.published})})]});}},{dataIndex:'title',title:'Título',ellipsis:true,width:300,responsive:['sm'],render:function render(title){return/*#__PURE__*/_jsx(Tooltip,{title:title,children:title});}},{dataIndex:'createdAt',title:'Criação',width:180,align:'center',responsive:['sm'],render:function render(item){return moment(item).format('DD/MM/YYYY');}},{dataIndex:'updatedAt',title:'Última atualização',width:200,align:'center',responsive:['sm'],render:function render(item){return moment(item).format('DD/MM/YYYY \\\\à\\\\s hh:mm');}},{dataIndex:'published',title:'Publicado',align:'center',width:120,responsive:['sm'],render:function render(published,post){return/*#__PURE__*/_jsx(Switch,{checked:published,loading:loadingToggle,onChange:function onChange(){togglePostStatus(post).then(function(){fetchUserPosts(user.id);});}});}}]})})]})]});}","map":{"version":3,"sources":["D:/ReactProjetos/alganews-admin/src/app/views/UserDetails.view.tsx"],"names":["Button","Card","Col","Row","Skeleton","Space","Typography","Progress","Descriptions","Divider","Popconfirm","Table","Switch","Tooltip","Avatar","useBreakpoint","confirm","useEffect","Link","Redirect","useParams","useUser","WarningFilled","moment","usePosts","NotFoundError","usePageTitle","useState","formatPhone","useBreadcrumb","UserDetailsView","params","page","setPage","lg","user","fetchUser","notFound","toggleUserStatus","name","fetchUserPosts","posts","togglePostStatus","loadingFetch","loadingToggle","isNaN","Number","id","role","avatarUrls","small","width","textAlign","rows","bio","active","canBeDeactivated","canBeActivated","icon","color","title","onOk","then","content","skills","length","map","skill","percentage","percent","location","country","state","city","phone","onChange","total","totalElements","pageSize","responsive","render","element","createdAt","format","updatedAt","published","dataIndex","ellipsis","align","item","post"],"mappings":"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","sourcesContent":["import {\n  Button,\n  Card,\n  Col,\n  Row,\n  Skeleton,\n  Space,\n  Typography,\n  Progress,\n  Descriptions,\n  Divider,\n  Popconfirm,\n  Table,\n  Switch,\n  Tooltip,\n} from 'antd';\nimport Avatar from 'antd/lib/avatar/avatar';\nimport useBreakpoint from 'antd/lib/grid/hooks/useBreakpoint';\nimport confirm from 'antd/lib/modal/confirm';\nimport { useEffect } from 'react';\nimport { Link, Redirect, useParams } from 'react-router-dom';\nimport useUser from '../../core/hooks/useUser';\nimport { WarningFilled } from '@ant-design/icons';\nimport moment from 'moment';\nimport { Post } from 'danielbonifacio-sdk';\nimport usePosts from '../../core/hooks/usePosts';\nimport NotFoundError from '../components/NotFoundError';\nimport usePageTitle from '../../core/hooks/usePageTitle';\nimport { useState } from 'react';\nimport formatPhone from '../../core/utils/formatPhone';\nimport useBreadcrumb from '../../core/hooks/useBreadcrumb';\n\nexport default function UserDetailsView() {\n  usePageTitle('Detalhes do usuário');\n\n  const params = useParams<{ id: string }>();\n  const [page, setPage] = useState(0);\n  const { lg } = useBreakpoint();\n\n  const { user, fetchUser, notFound, toggleUserStatus } = useUser();\n\n  useBreadcrumb(`Usuários/${user?.name || 'Detalhes'}`);\n  const {\n    fetchUserPosts,\n    posts,\n    togglePostStatus,\n    loadingFetch,\n    loadingToggle,\n  } = usePosts();\n\n  useEffect(() => {\n    if (!isNaN(Number(params.id))) fetchUser(Number(params.id));\n  }, [fetchUser, params.id]);\n\n  useEffect(() => {\n    if (user?.role === 'EDITOR') fetchUserPosts(user.id, page);\n  }, [fetchUserPosts, user, page]);\n\n  if (isNaN(Number(params.id))) return <Redirect to={'/usuarios'} />;\n\n  if (notFound)\n    return (\n      <Card>\n        <NotFoundError\n          title={'Usuário não encontrado'}\n          actionDestination={'/usuarios'}\n          actionTitle={'Voltar para lista de usuários'}\n        />\n      </Card>\n    );\n\n  if (!user) return <Skeleton />;\n\n  return (\n    <Row gutter={24}>\n      <Col xs={24} lg={4}>\n        <Row justify={'center'}>\n          <Avatar size={120} src={user.avatarUrls.small} />\n        </Row>\n      </Col>\n      <Col xs={24} lg={20}>\n        <Space\n          style={{ width: '100%' }}\n          direction={'vertical'}\n          align={lg ? 'start' : 'center'}\n        >\n          <Typography.Title level={2}>{user.name}</Typography.Title>\n          <Typography.Paragraph\n            style={{\n              textAlign: lg ? 'left' : 'center',\n            }}\n            ellipsis={{\n              rows: 2,\n            }}\n          >\n            {user.bio}\n          </Typography.Paragraph>\n          <Space>\n            <Link to={`/usuarios/edicao/${user.id}`}>\n              <Button type={'primary'}>Editar perfil</Button>\n            </Link>\n            <Popconfirm\n              disabled={\n                (user.active && !user.canBeDeactivated) ||\n                (!user.active && !user.canBeActivated)\n              }\n              title={\n                user.active\n                  ? `Desabilitar ${user.name}`\n                  : `Habilitar ${user.name}`\n              }\n              onConfirm={() => {\n                confirm({\n                  icon: <WarningFilled style={{ color: '#09f' }} />,\n                  title: `Tem certeza que deseja ${\n                    user.active\n                      ? `desabilitar ${user.name}?`\n                      : `habilitar ${user.name}?`\n                  }`,\n                  onOk() {\n                    toggleUserStatus(user).then(() => {\n                      fetchUser(Number(params.id));\n                    });\n                  },\n                  content: user.active\n                    ? 'Desabilitar um usuário fará com que ele seja automaticamente desligado da plataforma, podendo causar prejuízos em seus ganhos.'\n                    : 'Habilitar um usuário fará com que ele ganhe acesso a plataforma novamente, possibilitando criação e publicação de posts.',\n                });\n              }}\n            >\n              <Button\n                disabled={\n                  (user.active && !user.canBeDeactivated) ||\n                  (!user.active && !user.canBeActivated)\n                }\n                type={'primary'}\n              >\n                {user.active ? 'Desabilitar' : 'Habilitar'}\n              </Button>\n            </Popconfirm>\n          </Space>\n        </Space>\n      </Col>\n      <Divider />\n      {!!user.skills?.length && (\n        <Col xs={24} lg={12}>\n          <Space direction='vertical' style={{ width: '100%' }}>\n            {user.skills?.map((skill) => (\n              <div key={skill.name}>\n                <Typography.Text>{skill.name}</Typography.Text>\n                <Progress percent={skill.percentage} success={{ percent: 0 }} />\n              </div>\n            ))}\n          </Space>\n        </Col>\n      )}\n      <Col xs={24} lg={12}>\n        <Descriptions column={1} bordered size={'small'}>\n          <Descriptions.Item label={'País'}>\n            {user.location.country}\n          </Descriptions.Item>\n          <Descriptions.Item label={'Estado'}>\n            {user.location.state}\n          </Descriptions.Item>\n          <Descriptions.Item label={'Cidade'}>\n            {user.location.city}\n          </Descriptions.Item>\n          <Descriptions.Item label={'Telefone'}>\n            {formatPhone(user.phone)}\n          </Descriptions.Item>\n        </Descriptions>\n      </Col>\n      {user.role === 'EDITOR' && (\n        <>\n          <Divider />\n          <Col xs={24}>\n            <Table<Post.Summary>\n              dataSource={posts?.content}\n              rowKey={'id'}\n              loading={loadingFetch}\n              pagination={{\n                onChange: (page) => setPage(page - 1),\n                total: posts?.totalElements,\n                pageSize: 10,\n              }}\n              columns={[\n                {\n                  responsive: ['xs'],\n                  title: 'Posts',\n                  render(element) {\n                    return (\n                      <Descriptions column={1}>\n                        <Descriptions.Item label={'Título'}>\n                          {element.title}\n                        </Descriptions.Item>\n                        <Descriptions.Item label={'Criação'}>\n                          {moment(element.createdAt).format('DD/MM/YYYY')}\n                        </Descriptions.Item>\n                        <Descriptions.Item label={'Atualização'}>\n                          {moment(element.updatedAt).format('DD/MM/YYYY')}\n                        </Descriptions.Item>\n                        <Descriptions.Item label={'Publicado'}>\n                          <Switch checked={element.published} />\n                        </Descriptions.Item>\n                      </Descriptions>\n                    );\n                  },\n                },\n                {\n                  dataIndex: 'title',\n                  title: 'Título',\n                  ellipsis: true,\n                  width: 300,\n                  responsive: ['sm'],\n                  render(title: string) {\n                    return <Tooltip title={title}>{title}</Tooltip>;\n                  },\n                },\n                {\n                  dataIndex: 'createdAt',\n                  title: 'Criação',\n                  width: 180,\n                  align: 'center',\n                  responsive: ['sm'],\n                  render: (item) => moment(item).format('DD/MM/YYYY'),\n                },\n                {\n                  dataIndex: 'updatedAt',\n                  title: 'Última atualização',\n                  width: 200,\n                  align: 'center',\n                  responsive: ['sm'],\n                  render: (item) =>\n                    moment(item).format('DD/MM/YYYY \\\\à\\\\s hh:mm'),\n                },\n                {\n                  dataIndex: 'published',\n                  title: 'Publicado',\n                  align: 'center',\n                  width: 120,\n                  responsive: ['sm'],\n                  render(published: boolean, post) {\n                    return (\n                      <Switch\n                        checked={published}\n                        loading={loadingToggle}\n                        onChange={() => {\n                          togglePostStatus(post).then(() => {\n                            fetchUserPosts(user.id);\n                          });\n                        }}\n                      />\n                    );\n                  },\n                },\n              ]}\n            />\n          </Col>\n        </>\n      )}\n    </Row>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}