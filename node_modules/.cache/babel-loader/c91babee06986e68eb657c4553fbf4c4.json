{"ast":null,"code":"import _regeneratorRuntime from\"D:/ReactProjetos/alganews-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"D:/ReactProjetos/alganews-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"D:/ReactProjetos/alganews-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{createAsyncThunk,createSlice}from'@reduxjs/toolkit';import{CashFlowService}from'danielbonifacio-sdk';import moment from'moment';import getThunkStatus from'../utils/getThunkStatus';var initialState={list:[],fetching:false,query:{type:'REVENUE',sort:['transactedOn','desc'],yearMonth:moment().format('YYYY-MM')},selected:[]};export var getRevenues=createAsyncThunk('cash-flow/revenues/getRevenues',/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_,_ref){var getState,dispatch,rejectWithValue,query,revenues;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:getState=_ref.getState,dispatch=_ref.dispatch,rejectWithValue=_ref.rejectWithValue;_context.prev=1;query=getState().cashFlow.revenue.query;_context.next=5;return CashFlowService.getAllEntries(query);case 5:revenues=_context.sent;_context.next=8;return dispatch(storeList(revenues));case 8:_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](1);return _context.abrupt(\"return\",rejectWithValue(_objectSpread({},_context.t0)));case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,10]]);}));return function(_x,_x2){return _ref2.apply(this,arguments);};}());export var createRevenue=createAsyncThunk('cash-flow/revenues/createRevenue',/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(revenue,_ref3){var dispatch,rejectWithValue;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch=_ref3.dispatch,rejectWithValue=_ref3.rejectWithValue;_context2.prev=1;_context2.next=4;return CashFlowService.insertNewEntry(revenue);case 4:_context2.next=6;return dispatch(getRevenues());case 6:_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);return _context2.abrupt(\"return\",rejectWithValue(_objectSpread({},_context2.t0)));case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return function(_x3,_x4){return _ref4.apply(this,arguments);};}());export var updateRevenue=createAsyncThunk('cash-flow/revenues/updateRevenue',/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref5,_ref6){var entry,entryId,dispatch,rejectWithValue;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:entry=_ref5.entry,entryId=_ref5.entryId;dispatch=_ref6.dispatch,rejectWithValue=_ref6.rejectWithValue;_context3.prev=2;_context3.next=5;return CashFlowService.updateExistingEntry(entryId,entry);case 5:_context3.next=7;return dispatch(getRevenues());case 7:_context3.next=12;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](2);return _context3.abrupt(\"return\",rejectWithValue(_objectSpread({},_context3.t0)));case 12:case\"end\":return _context3.stop();}}},_callee3,null,[[2,9]]);}));return function(_x5,_x6){return _ref7.apply(this,arguments);};}());export var removeRevenue=createAsyncThunk('cash-flow/revenues/removeRevenue',/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(revenueId,_ref8){var dispatch,rejectWithValue;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:dispatch=_ref8.dispatch,rejectWithValue=_ref8.rejectWithValue;_context4.prev=1;_context4.next=4;return CashFlowService.removeExistingEntry(revenueId);case 4:_context4.next=6;return dispatch(getRevenues());case 6:_context4.next=11;break;case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](1);return _context4.abrupt(\"return\",rejectWithValue(_objectSpread({},_context4.t0)));case 11:case\"end\":return _context4.stop();}}},_callee4,null,[[1,8]]);}));return function(_x7,_x8){return _ref9.apply(this,arguments);};}());export var removeEntriesInBatch=createAsyncThunk('cash-flow/revenues/removeEntriesInBatch',/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(ids,_ref10){var dispatch;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:dispatch=_ref10.dispatch;_context5.next=3;return CashFlowService.removeEntriesBatch(ids);case 3:_context5.next=5;return dispatch(getRevenues());case 5:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x9,_x10){return _ref11.apply(this,arguments);};}());export var setQuery=createAsyncThunk('cash-flow/revenues/setQuery',/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(query,_ref12){var dispatch;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:dispatch=_ref12.dispatch;_context6.next=3;return dispatch(_setQuery(query));case 3:_context6.next=5;return dispatch(getRevenues());case 5:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x11,_x12){return _ref13.apply(this,arguments);};}());var revenueSlice=createSlice({initialState:initialState,name:'cash-flow/revenues',reducers:{storeList:function storeList(state,action){state.list=action.payload;},setSelectedRevenues:function setSelectedRevenues(state,action){state.selected=action.payload;},setQuery:function setQuery(state,action){state.query=_objectSpread(_objectSpread({},state.query),action.payload);},setFetching:function setFetching(state,action){state.fetching=action.payload;}},extraReducers:function extraReducers(builder){var _getThunkStatus=getThunkStatus([getRevenues,removeEntriesInBatch,createRevenue]),error=_getThunkStatus.error,loading=_getThunkStatus.loading,success=_getThunkStatus.success;builder.addMatcher(error,function(state){state.fetching=false;}).addMatcher(success,function(state){state.fetching=false;}).addMatcher(loading,function(state){state.fetching=true;});}});var _revenueSlice$actions=revenueSlice.actions,storeList=_revenueSlice$actions.storeList,setSelectedRevenues=_revenueSlice$actions.setSelectedRevenues,_setQuery=_revenueSlice$actions.setQuery,setFetching=_revenueSlice$actions.setFetching;export{storeList,setSelectedRevenues,_setQuery,setFetching};var revenueReducer=revenueSlice.reducer;export default revenueReducer;","map":{"version":3,"sources":["D:/ReactProjetos/alganews-admin/src/core/store/Revenue.slice.ts"],"names":["createAsyncThunk","createSlice","CashFlowService","moment","getThunkStatus","initialState","list","fetching","query","type","sort","yearMonth","format","selected","getRevenues","_","getState","dispatch","rejectWithValue","cashFlow","revenue","getAllEntries","revenues","storeList","createRevenue","insertNewEntry","updateRevenue","entry","entryId","updateExistingEntry","removeRevenue","revenueId","removeExistingEntry","removeEntriesInBatch","ids","removeEntriesBatch","setQuery","_setQuery","revenueSlice","name","reducers","state","action","payload","setSelectedRevenues","setFetching","extraReducers","builder","error","loading","success","addMatcher","actions","revenueReducer","reducer"],"mappings":"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","sourcesContent":["import { createAsyncThunk, createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { Key } from 'antd/lib/table/interface';\nimport { CashFlow, CashFlowService } from 'danielbonifacio-sdk';\nimport moment from 'moment';\nimport { RootState } from '.';\nimport getThunkStatus from '../utils/getThunkStatus';\n\ninterface RevenueState {\n  list: CashFlow.EntrySummary[];\n  fetching: boolean;\n  query: CashFlow.Query;\n  selected: Key[];\n}\n\nconst initialState: RevenueState = {\n  list: [],\n  fetching: false,\n  query: {\n    type: 'REVENUE',\n    sort: ['transactedOn', 'desc'],\n    yearMonth: moment().format('YYYY-MM'),\n  },\n  selected: [],\n};\n\nexport const getRevenues = createAsyncThunk(\n  'cash-flow/revenues/getRevenues',\n  async (_, { getState, dispatch, rejectWithValue }) => {\n    try {\n      const { query } = (getState() as RootState).cashFlow.revenue;\n      const revenues = await CashFlowService.getAllEntries(query);\n      await dispatch(storeList(revenues));\n    } catch (err) {\n      return rejectWithValue({ ...err });\n    }\n  }\n);\n\nexport const createRevenue = createAsyncThunk(\n  'cash-flow/revenues/createRevenue',\n  async (revenue: CashFlow.EntryInput, { dispatch, rejectWithValue }) => {\n    try {\n      await CashFlowService.insertNewEntry(revenue);\n      await dispatch(getRevenues());\n    } catch (err) {\n      return rejectWithValue({ ...err });\n    }\n  }\n);\n\nexport const updateRevenue = createAsyncThunk(\n  'cash-flow/revenues/updateRevenue',\n  async (\n    { entry, entryId }: { entry: CashFlow.EntryInput; entryId: number },\n    { dispatch, rejectWithValue }\n  ) => {\n    try {\n      await CashFlowService.updateExistingEntry(entryId, entry);\n      await dispatch(getRevenues());\n    } catch (err) {\n      return rejectWithValue({ ...err });\n    }\n  }\n);\n\nexport const removeRevenue = createAsyncThunk(\n  'cash-flow/revenues/removeRevenue',\n  async (revenueId: number, { dispatch, rejectWithValue }) => {\n    try {\n      await CashFlowService.removeExistingEntry(revenueId);\n      await dispatch(getRevenues());\n    } catch (err) {\n      return rejectWithValue({ ...err });\n    }\n  }\n);\n\nexport const removeEntriesInBatch = createAsyncThunk(\n  'cash-flow/revenues/removeEntriesInBatch',\n  async (ids: number[], { dispatch }) => {\n    await CashFlowService.removeEntriesBatch(ids);\n    await dispatch(getRevenues());\n  }\n);\n\nexport const setQuery = createAsyncThunk(\n  'cash-flow/revenues/setQuery',\n  async (query: Partial<CashFlow.Query>, { dispatch }) => {\n    await dispatch(_setQuery(query));\n    await dispatch(getRevenues());\n  }\n);\n\nconst revenueSlice = createSlice({\n  initialState,\n  name: 'cash-flow/revenues',\n  reducers: {\n    storeList(state, action: PayloadAction<CashFlow.EntrySummary[]>) {\n      state.list = action.payload;\n    },\n    setSelectedRevenues(state, action: PayloadAction<Key[]>) {\n      state.selected = action.payload;\n    },\n    setQuery(state, action: PayloadAction<Partial<CashFlow.Query>>) {\n      state.query = {\n        ...state.query,\n        ...action.payload,\n      };\n    },\n    setFetching(state, action: PayloadAction<boolean>) {\n      state.fetching = action.payload;\n    },\n  },\n  extraReducers(builder) {\n    const { error, loading, success } = getThunkStatus([\n      getRevenues,\n      removeEntriesInBatch,\n      createRevenue,\n    ]);\n\n    builder\n      .addMatcher(error, (state) => {\n        state.fetching = false;\n      })\n      .addMatcher(success, (state) => {\n        state.fetching = false;\n      })\n      .addMatcher(loading, (state) => {\n        state.fetching = true;\n      });\n  },\n});\n\nexport const {\n  storeList,\n  setSelectedRevenues,\n  setQuery: _setQuery,\n  setFetching,\n} = revenueSlice.actions;\n\nconst revenueReducer = revenueSlice.reducer;\nexport default revenueReducer;\n"]},"metadata":{},"sourceType":"module"}