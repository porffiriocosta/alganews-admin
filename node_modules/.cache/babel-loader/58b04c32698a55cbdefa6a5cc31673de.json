{"ast":null,"code":"import _regeneratorRuntime from\"D:/ReactProjetos/alganews-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/ReactProjetos/alganews-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{PrinterOutlined,CheckCircleOutlined}from'@ant-design/icons';import{Button,Card,Divider,notification,Space,Tag}from'antd';import moment from'moment';import{useEffect}from'react';import{useHistory,useParams}from'react-router-dom';import useBreadcrumb from'../../core/hooks/useBreadcrumb';import usePageTitle from'../../core/hooks/usePageTitle';import usePayment from'../../core/hooks/usePayment';import DoubleConfirm from'../components/DoubleConfirm';import NotFoundError from'../components/NotFoundError';import PaymentBonuses from'../features/PaymentBonuses';import PaymentHeader from'../features/PaymentHeader';import PaymentPosts from'../features/PaymentPosts';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function PaymentDetailsView(){usePageTitle('Detalhes do pagamento');useBreadcrumb('Pagamento/Detalhes');var params=useParams();var history=useHistory();var _usePayment=usePayment(),fetchPayment=_usePayment.fetchPayment,fetchPosts=_usePayment.fetchPosts,fetchingPayment=_usePayment.fetchingPayment,fetchingPosts=_usePayment.fetchingPosts,paymentNotFound=_usePayment.paymentNotFound,approvingPayment=_usePayment.approvingPayment,approvePayment=_usePayment.approvePayment,payment=_usePayment.payment,posts=_usePayment.posts;useEffect(function(){var paymentId=Number(params.id);if(isNaN(paymentId)){return history.push('/pagamentos');}else{fetchPosts(paymentId);fetchPayment(paymentId);}},[fetchPosts,fetchPayment,params.id,history]);if(paymentNotFound)return/*#__PURE__*/_jsx(NotFoundError,{title:\"Pagamento n\\xE3o encontrado\",actionDestination:\"/pagamentos\",actionTitle:'Ir para a lista de pagamentos'});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Space,{style:{marginBottom:16},children:[/*#__PURE__*/_jsx(Button,{className:\"no-print\",disabled:!payment,type:'primary',icon:/*#__PURE__*/_jsx(PrinterOutlined,{}),onClick:window.print,children:\"Imprimir\"}),(payment===null||payment===void 0?void 0:payment.approvedAt)?/*#__PURE__*/_jsxs(Tag,{children:[\"Pagamento aprovado em\",' ',moment(payment.approvedAt).format('DD/MM/YYYY')]}):/*#__PURE__*/_jsx(DoubleConfirm,{popConfirmTitle:'Deseja aprovar este agendamento?',modalTitle:'Ação irreversível',disabled:!payment||!payment.canBeApproved,modalContent:'Aprovar um agendamento de pagamento gera uma despesa que não pode ser removida do fluxo de caixa. Essa ação não poderá ser desfeita.',onConfirm:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!payment){_context.next=5;break;}_context.next=3;return approvePayment(payment.id);case 3:fetchPayment(payment.id);notification.success({message:'Pagamento aprovado com sucesso'});case 5:case\"end\":return _context.stop();}}},_callee);})),children:/*#__PURE__*/_jsx(Button,{loading:approvingPayment,disabled:!payment||!payment.canBeApproved,icon:/*#__PURE__*/_jsx(CheckCircleOutlined,{}),type:'primary',danger:true,children:\"Aprovar agendamento\"})})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(PaymentHeader,{loading:fetchingPayment,editorId:payment===null||payment===void 0?void 0:payment.payee.id,editorName:payment===null||payment===void 0?void 0:payment.payee.name,periodStart:moment(payment===null||payment===void 0?void 0:payment.accountingPeriod.startsOn).format('DD/MM/YYYY'),periodEnd:moment(payment===null||payment===void 0?void 0:payment.accountingPeriod.endsOn).format('DD/MM/YYYY'),postsEarnings:payment===null||payment===void 0?void 0:payment.earnings.totalAmount,totalEarnings:payment===null||payment===void 0?void 0:payment.grandTotalAmount}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(PaymentBonuses,{loading:fetchingPayment,bonuses:payment===null||payment===void 0?void 0:payment.bonuses}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(PaymentPosts,{loading:fetchingPosts,posts:posts})]})]});}","map":{"version":3,"sources":["D:/ReactProjetos/alganews-admin/src/app/views/PaymentDetails.view.tsx"],"names":["PrinterOutlined","CheckCircleOutlined","Button","Card","Divider","notification","Space","Tag","moment","useEffect","useHistory","useParams","useBreadcrumb","usePageTitle","usePayment","DoubleConfirm","NotFoundError","PaymentBonuses","PaymentHeader","PaymentPosts","PaymentDetailsView","params","history","fetchPayment","fetchPosts","fetchingPayment","fetchingPosts","paymentNotFound","approvingPayment","approvePayment","payment","posts","paymentId","Number","id","isNaN","push","marginBottom","window","print","approvedAt","format","canBeApproved","success","message","payee","name","accountingPeriod","startsOn","endsOn","earnings","totalAmount","grandTotalAmount","bonuses"],"mappings":"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","sourcesContent":["import { PrinterOutlined, CheckCircleOutlined } from '@ant-design/icons';\nimport { Button, Card, Divider, notification, Space, Tag } from 'antd';\nimport moment from 'moment';\nimport { useEffect } from 'react';\nimport { useHistory, useParams } from 'react-router-dom';\nimport useBreadcrumb from '../../core/hooks/useBreadcrumb';\nimport usePageTitle from '../../core/hooks/usePageTitle';\nimport usePayment from '../../core/hooks/usePayment';\nimport DoubleConfirm from '../components/DoubleConfirm';\nimport NotFoundError from '../components/NotFoundError';\nimport PaymentBonuses from '../features/PaymentBonuses';\nimport PaymentHeader from '../features/PaymentHeader';\nimport PaymentPosts from '../features/PaymentPosts';\n\nexport default function PaymentDetailsView() {\n  usePageTitle('Detalhes do pagamento');\n  useBreadcrumb('Pagamento/Detalhes');\n  const params = useParams<{ id: string }>();\n  const history = useHistory();\n\n  const {\n    fetchPayment,\n    fetchPosts,\n    fetchingPayment,\n    fetchingPosts,\n    paymentNotFound,\n    approvingPayment,\n    approvePayment,\n    payment,\n    posts,\n  } = usePayment();\n\n  useEffect(() => {\n    const paymentId = Number(params.id);\n    if (isNaN(paymentId)) {\n      return history.push('/pagamentos');\n    } else {\n      fetchPosts(paymentId);\n      fetchPayment(paymentId);\n    }\n  }, [fetchPosts, fetchPayment, params.id, history]);\n\n  if (paymentNotFound)\n    return (\n      <NotFoundError\n        title='Pagamento não encontrado'\n        actionDestination='/pagamentos'\n        actionTitle={'Ir para a lista de pagamentos'}\n      />\n    );\n\n  return (\n    <>\n      <Space style={{ marginBottom: 16 }}>\n        <Button\n          className='no-print'\n          disabled={!payment}\n          type={'primary'}\n          icon={<PrinterOutlined />}\n          onClick={window.print}\n        >\n          Imprimir\n        </Button>\n        {payment?.approvedAt ? (\n          <Tag>\n            Pagamento aprovado em{' '}\n            {moment(payment.approvedAt).format('DD/MM/YYYY')}\n          </Tag>\n        ) : (\n          <DoubleConfirm\n            popConfirmTitle={'Deseja aprovar este agendamento?'}\n            modalTitle={'Ação irreversível'}\n            disabled={!payment || !payment.canBeApproved}\n            modalContent={\n              'Aprovar um agendamento de pagamento gera uma despesa que não pode ser removida do fluxo de caixa. Essa ação não poderá ser desfeita.'\n            }\n            onConfirm={async () => {\n              if (payment) {\n                await approvePayment(payment.id);\n                fetchPayment(payment.id);\n                notification.success({\n                  message: 'Pagamento aprovado com sucesso',\n                });\n              }\n            }}\n          >\n            <Button\n              loading={approvingPayment}\n              disabled={!payment || !payment.canBeApproved}\n              icon={<CheckCircleOutlined />}\n              type={'primary'}\n              danger\n            >\n              Aprovar agendamento\n            </Button>\n          </DoubleConfirm>\n        )}\n      </Space>\n      <Card>\n        <PaymentHeader\n          loading={fetchingPayment}\n          editorId={payment?.payee.id}\n          editorName={payment?.payee.name}\n          periodStart={moment(payment?.accountingPeriod.startsOn).format(\n            'DD/MM/YYYY'\n          )}\n          periodEnd={moment(payment?.accountingPeriod.endsOn).format(\n            'DD/MM/YYYY'\n          )}\n          postsEarnings={payment?.earnings.totalAmount}\n          totalEarnings={payment?.grandTotalAmount}\n        />\n        <Divider />\n        <PaymentBonuses loading={fetchingPayment} bonuses={payment?.bonuses} />\n        <Divider />\n        <PaymentPosts loading={fetchingPosts} posts={posts} />\n      </Card>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}